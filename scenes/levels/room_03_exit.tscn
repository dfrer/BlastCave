[gd_scene load_steps=16 format=3]

[ext_resource type="PackedScene" path="res://scenes/kit/cave_ramp.tscn" id="1_ramp"]
[ext_resource type="PackedScene" path="res://scenes/pickup_explosive.tscn" id="2_pickup"]
[ext_resource type="PackedScene" path="res://scenes/kit/bounce_pad.tscn" id="3_bounce"]
[ext_resource type="PackedScene" path="res://scenes/kit/bouncy_surface.tscn" id="4_bouncy"]

[sub_resource type="StandardMaterial3D" id="mat_shaft"]
albedo_color = Color(0.24, 0.22, 0.2, 1)
roughness = 0.85
metallic = 0.05

[sub_resource type="StandardMaterial3D" id="mat_platform"]
albedo_color = Color(0.32, 0.3, 0.28, 1)
roughness = 0.7
metallic = 0.15

[sub_resource type="StandardMaterial3D" id="mat_exit_glow"]
albedo_color = Color(0.2, 0.9, 0.5, 1)
emission_enabled = true
emission = Color(0.3, 1.0, 0.6, 1)
emission_energy_multiplier = 3.0

[sub_resource type="CylinderMesh" id="mesh_shaft_floor"]
top_radius = 10.0
bottom_radius = 9.0
height = 2.0

[sub_resource type="CylinderShape3D" id="shape_shaft_floor"]
radius = 10.0
height = 2.0

[sub_resource type="BoxMesh" id="mesh_spiral_section"]
size = Vector3(4, 0.5, 8)

[sub_resource type="BoxShape3D" id="shape_spiral_section"]
size = Vector3(4, 0.5, 8)

[sub_resource type="SphereMesh" id="mesh_exit_beacon"]
radius = 0.5
height = 1.0

[sub_resource type="PhysicsMaterial" id="physics_smooth"]
friction = 0.2
bounce = 0.35

[node name="Room03Exit" type="Node3D"]

[node name="Entry" type="Marker3D" parent="." groups=["chunk_entry"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -6, 8)

[node name="Exit" type="Marker3D" parent="." groups=["chunk_exit"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 12, 0)

[node name="Geometry" type="Node3D" parent="."]

[node name="ShaftFloor" type="StaticBody3D" parent="Geometry"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -8, 0)
physics_material_override = SubResource("physics_smooth")

[node name="Mesh" type="MeshInstance3D" parent="Geometry/ShaftFloor"]
mesh = SubResource("mesh_shaft_floor")
material_override = SubResource("mat_shaft")

[node name="Collision" type="CollisionShape3D" parent="Geometry/ShaftFloor"]
shape = SubResource("shape_shaft_floor")

[node name="SpiralRamp1" type="StaticBody3D" parent="Geometry"]
transform = Transform3D(0.965926, 0, 0.258819, 0, 1, 0, -0.258819, 0, 0.965926, -7, -5, 0)
physics_material_override = SubResource("physics_smooth")

[node name="Mesh" type="MeshInstance3D" parent="Geometry/SpiralRamp1"]
mesh = SubResource("mesh_spiral_section")
material_override = SubResource("mat_platform")

[node name="Collision" type="CollisionShape3D" parent="Geometry/SpiralRamp1"]
shape = SubResource("shape_spiral_section")

[node name="SpiralRamp2" type="StaticBody3D" parent="Geometry"]
transform = Transform3D(0.258819, 0, -0.965926, 0, 1, 0, 0.965926, 0, 0.258819, 0, -2, -7)
physics_material_override = SubResource("physics_smooth")

[node name="Mesh" type="MeshInstance3D" parent="Geometry/SpiralRamp2"]
mesh = SubResource("mesh_spiral_section")
material_override = SubResource("mat_platform")

[node name="Collision" type="CollisionShape3D" parent="Geometry/SpiralRamp2"]
shape = SubResource("shape_spiral_section")

[node name="SpiralRamp3" type="StaticBody3D" parent="Geometry"]
transform = Transform3D(-0.965926, 0, -0.258819, 0, 1, 0, 0.258819, 0, -0.965926, 7, 1, 0)
physics_material_override = SubResource("physics_smooth")

[node name="Mesh" type="MeshInstance3D" parent="Geometry/SpiralRamp3"]
mesh = SubResource("mesh_spiral_section")
material_override = SubResource("mat_platform")

[node name="Collision" type="CollisionShape3D" parent="Geometry/SpiralRamp3"]
shape = SubResource("shape_spiral_section")

[node name="SpiralRamp4" type="StaticBody3D" parent="Geometry"]
transform = Transform3D(-0.258819, 0, 0.965926, 0, 1, 0, -0.965926, 0, -0.258819, 0, 4, 7)
physics_material_override = SubResource("physics_smooth")

[node name="Mesh" type="MeshInstance3D" parent="Geometry/SpiralRamp4"]
mesh = SubResource("mesh_spiral_section")
material_override = SubResource("mat_platform")

[node name="Collision" type="CollisionShape3D" parent="Geometry/SpiralRamp4"]
shape = SubResource("shape_spiral_section")

[node name="ExitPlatform" type="StaticBody3D" parent="Geometry"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 8, 0)
physics_material_override = SubResource("physics_smooth")

[node name="Mesh" type="MeshInstance3D" parent="Geometry/ExitPlatform"]
mesh = SubResource("mesh_spiral_section")
scale = Vector3(1.5, 1, 1.5)
material_override = SubResource("mat_platform")

[node name="Collision" type="CollisionShape3D" parent="Geometry/ExitPlatform"]
shape = SubResource("shape_spiral_section")
scale = Vector3(1.5, 1, 1.5)

[node name="BouncePads" type="Node3D" parent="."]

[node name="BouncePadCenter" parent="BouncePads" instance=ExtResource("3_bounce")]
transform = Transform3D(1.5, 0, 0, 0, 1.5, 0, 0, 0, 1.5, 0, -6.8, 0)

[node name="BouncePad1" parent="BouncePads" instance=ExtResource("3_bounce")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, -6.8, 4)

[node name="BouncePad2" parent="BouncePads" instance=ExtResource("3_bounce")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, -6.8, -4)

[node name="BouncyWall1" parent="BouncePads" instance=ExtResource("4_bouncy")]
transform = Transform3D(0.258819, 0, 0.965926, 0, 1, 0, -0.965926, 0, 0.258819, -9, -2, 2)
scale = Vector3(0.3, 4, 2)

[node name="BouncyWall2" parent="BouncePads" instance=ExtResource("4_bouncy")]
transform = Transform3D(-0.258819, 0, 0.965926, 0, 1, 0, -0.965926, 0, -0.258819, 9, -2, -2)
scale = Vector3(0.3, 4, 2)

[node name="BouncyWall3" parent="BouncePads" instance=ExtResource("4_bouncy")]
transform = Transform3D(0.965926, 0, 0.258819, 0, 1, 0, -0.258819, 0, 0.965926, 2, 4, 9)
scale = Vector3(0.3, 3, 2)

[node name="Pickups" type="Node3D" parent="."]

[node name="PickupCenter" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -6, 0)
explosive_type = "ImpulseCharge"
amount = 3

[node name="Pickup1" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6, -6, 3)
explosive_type = "ImpulseCharge"
amount = 2

[node name="Pickup2" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6, -6, -3)
explosive_type = "ImpulseCharge"
amount = 2

[node name="PickupSpiral1" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -6, -4.5, 0)
explosive_type = "ShapedCharge"
amount = 2

[node name="PickupSpiral2" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1.5, -6)
explosive_type = "ShapedCharge"
amount = 2

[node name="PickupSpiral3" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6, 1.5, 0)
explosive_type = "DelayedCharge"
amount = 2

[node name="PickupSpiral4" parent="Pickups" instance=ExtResource("2_pickup")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 4.5, 6)
explosive_type = "DelayedCharge"
amount = 2

[node name="Decoration" type="Node3D" parent="."]

[node name="ExitBeacon" type="MeshInstance3D" parent="Decoration"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 10, 0)
mesh = SubResource("mesh_exit_beacon")
material_override = SubResource("mat_exit_glow")

[node name="Lighting" type="Node3D" parent="."]

[node name="BottomLight" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -4, 0)
light_color = Color(0.6, 0.7, 0.9, 1)
light_energy = 0.8
omni_range = 15.0

[node name="MidLight" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)
light_color = Color(0.5, 0.8, 0.9, 1)
light_energy = 0.6
omni_range = 12.0

[node name="ExitLight" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 10, 0)
light_color = Color(0.3, 1.0, 0.5, 1)
light_energy = 1.5
omni_range = 10.0
